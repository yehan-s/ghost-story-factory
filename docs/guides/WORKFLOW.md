# Ghost Story Factory - å®Œæ•´å·¥ä½œæµç¨‹æŒ‡å—

> **Version:** v3.1 ğŸ¯
> **æ›´æ–°æ—¥æœŸ:** 2025-10-24
> **é€‚ç”¨äº:** åŸºäº"templates"çš„å®Œæ•´æ•…äº‹ç”Ÿæˆæµç¨‹

---

## ğŸ“‹ ç›®å½•

1. [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
2. [å®Œæ•´æµç¨‹](#å®Œæ•´æµç¨‹-æ¨è)
3. [ç®€åŒ–æµç¨‹](#ç®€åŒ–æµç¨‹-å¿«é€Ÿç”Ÿæˆ)
4. [å‘½ä»¤å‚è€ƒ](#å‘½ä»¤å‚è€ƒ)
5. [æ–‡ä»¶è¾“å‡ºè¯´æ˜](#æ–‡ä»¶è¾“å‡ºè¯´æ˜)

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### âš¡ æ–¹å¼ä¸€ï¼šè‡ªåŠ¨æµæ°´çº¿ï¼ˆæœ€æ¨èï¼ï¼‰

```bash
# 1. è®¾ç½®åŸå¸‚ï¼Œè·å–å€™é€‰æ•…äº‹
set-city --city "æ­å·"

# 2. é€‰æ‹©æ•…äº‹å¹¶ç”Ÿæˆç»“æ„æ¡†æ¶
get-struct --city "æ­å·" --index 1

# 3. ä¸€é”®ç”Ÿæˆæ‰€æœ‰å†…å®¹ï¼ˆè‡ªåŠ¨æ‰§è¡Œ 5 ä¸ªæ­¥éª¤ï¼ï¼‰
gen-complete --city "æ­å·" --index 1
```

**ğŸ¯ è‡ªåŠ¨å®Œæˆï¼š** Lore v1 â†’ ä¸»è§’è®¾è®¡ â†’ Lore v2 â†’ GDD â†’ ä¸»çº¿æ•…äº‹

---

### ğŸ¯ æ–¹å¼äºŒï¼šæ‰‹åŠ¨åˆ†æ­¥ï¼ˆç²¾ç»†æ§åˆ¶ï¼‰

```bash
# 1-2. è®¾ç½®åŸå¸‚å’Œé€‰æ‹©æ•…äº‹ï¼ˆåŒä¸Šï¼‰
set-city --city "æ­å·"
get-struct --city "æ­å·" --index 1

# 3-7. æ‰‹åŠ¨åˆ†æ­¥æ‰§è¡Œ
get-lore --city "æ­å·" --index 1
gen-protagonist --city "æ­å·"
gen-lore-v2 --city "æ­å·"
gen-gdd --city "æ­å·"
gen-main-thread --city "æ­å·"

# 8. (å¯é€‰) ç”Ÿæˆåˆ†æ”¯æ•…äº‹
gen-branch --city "æ­å·" --branch-name "åº—ä¸»çº¿"
```

### æ–¹å¼ä¸‰ï¼šç®€åŒ–æµç¨‹ï¼ˆå¿«é€Ÿï¼Œæ— æ¸¸æˆç³»ç»Ÿï¼‰

```bash
# 1-2. è®¾ç½®åŸå¸‚å’Œé€‰æ‹©æ•…äº‹
set-city --city "æ­å·"
get-struct --city "æ­å·" --index 1

# 3. ç›´æ¥ç”Ÿæˆç®€åŒ–ç‰ˆæ•…äº‹ï¼ˆè·³è¿‡ Lore v2/GDDï¼‰
get-story --city "æ­å·"
```

---

## ğŸ“ å®Œæ•´æµç¨‹ (æ¨è)

### Stage 1: å€™é€‰ä¸ç»“æ„

#### 1.1 è·å–å€™é€‰æ•…äº‹åˆ—è¡¨

```bash
set-city --city "æ­å·"
```

**è¾“å‡ºæ–‡ä»¶:** `æ­å·_candidates.json`
**å†…å®¹:** 5-7 ä¸ªå€™é€‰çµå¼‚ä¼ è¯´ï¼ŒåŒ…å« titleã€blurbã€source

**ç¤ºä¾‹è¾“å‡º:**
```json
[
  {
    "title": "åŒ—é«˜å³°åˆå¤œç¼†è½¦ç©ºå¢",
    "blurb": "å¤œçˆ¬è€…ç§°å‡Œæ™¨ç¼†è½¦è½¨é“ä¼ æ¥ç©ºå¢è¿è¡Œå£°ï¼Œç›‘æ§å´æ˜¾ç¤ºæ— è½¦å¢ç§»åŠ¨ã€‚",
    "source": "ç™¾åº¦è´´å§"æ­å·åŒ—é«˜å³°"æ·±å¤œè´´ï¼Œå…³é”®è¯"ç¼†è½¦ ç©ºç®± æ€ªå£°""
  },
  ...
]
```

#### 1.2 é€‰æ‹©æ•…äº‹å¹¶ç”Ÿæˆç»“æ„

```bash
get-struct --city "æ­å·" --index 1
# æˆ–æŒ‡å®šæ ‡é¢˜
get-struct --city "æ­å·" --title "åŒ—é«˜å³°åˆå¤œç¼†è½¦ç©ºå¢"
```

**è¾“å‡ºæ–‡ä»¶:** `æ­å·_struct.json`
**å†…å®¹:** æ•…äº‹æ¡†æ¶ï¼ŒåŒ…å« titleã€cityã€location_nameã€core_legendã€key_elementsã€potential_roles

---

### Stage 2: Lore v1 ä¸ä¸»è§’è®¾è®¡

#### 2.1 ç”Ÿæˆä¸–ç•Œè§‚åŸºç¡€ (Lore v1)

```bash
get-lore --city "æ­å·" --index 1
```

**è¾“å‡ºæ–‡ä»¶:** `æ­å·_lore.json`
**å†…å®¹:** ä¸–ç•Œè§‚åœ£ç»ï¼ŒåŒ…å«ï¼š
- `world_truth` - æ ¸å¿ƒçœŸç›¸
- `rules[]` - ä¸–ç•Œè§„åˆ™
- `motifs[]` - æ„è±¡ç¬¦å·
- `locations[]` - åœ°ç‚¹è®¾å®š
- `timeline_hints[]` - æ—¶é—´çº¿æç¤º
- `allowed_roles[]` - å¯é€‰è§’è‰²

#### 2.2 ç”Ÿæˆä¸»è§’è®¾è®¡

```bash
gen-protagonist --city "æ­å·"
```

**è¾“å‡ºæ–‡ä»¶:** `æ­å·_protagonist.md`
**å†…å®¹:** ä¸»è§’åˆ†ææŠ¥å‘Š (Markdown)
- ä¸‰ç»´è¯„ä¼°æ¨¡å‹ï¼ˆè®¿é—®æƒã€äº¤é›†ç‚¹ã€åŠ¨æœºï¼‰
- æ¯ä¸ªè§’è‰²çš„åˆ†æä¸ç»“è®º
- æœ€ç»ˆæ¨èçš„ä¸»è§’çº¿

---

### Stage 3: Lore v2 ä¸ GDD

#### 3.1 ç”Ÿæˆæ·±åŒ–ä¸–ç•Œè§‚ (Lore v2)

```bash
gen-lore-v2 --city "æ­å·"
```

**è¾“å‡ºæ–‡ä»¶:** `æ­å·_lore_v2.md`
**å†…å®¹:** ä¸–ç•Œä¹¦ 2.0 (ç³»ç»Ÿå¢å¼ºç‰ˆ)
- å®Œæ•´ä¿ç•™ Lore v1 å†…å®¹
- æ–°å¢ï¼šå…±é¸£åº¦ç³»ç»Ÿ
- æ–°å¢ï¼šå®ä½“è¡Œä¸ºç­‰çº§
- æ–°å¢ï¼šåæœæ ‘ (Consequence Tree)
- æ–°å¢ï¼šæ ¸å¿ƒæ¸¸æˆç³»ç»Ÿ

**ä¾èµ–:** éœ€è¦å…ˆè¿è¡Œ `get-lore`

#### 3.2 ç”Ÿæˆ AI å¯¼æ¼”ä»»åŠ¡ç®€æŠ¥ (GDD)

```bash
gen-gdd --city "æ­å·"
```

**è¾“å‡ºæ–‡ä»¶:** `æ­å·_GDD.md`
**å†…å®¹:** æ¸¸æˆè®¾è®¡æ–‡æ¡£ (Markdown)
- ä¸»è§’ç›®æ ‡ä¸è®¿é—®æƒ
- å…³é”®åœºæ™¯æµç¨‹ï¼ˆ5-6ä¸ªï¼‰
- ç³»ç»Ÿæ•´åˆï¼ˆå…±é¸£åº¦ã€åæœæ ‘ï¼‰
- AI å¯¼æ¼”æŒ‡ä»¤

**ä¾èµ–:** éœ€è¦å…ˆè¿è¡Œ `gen-lore-v2` å’Œ `gen-protagonist`

---

### Stage 4: å®Œæ•´æ•…äº‹ç”Ÿæˆ

#### 4.1 ç”Ÿæˆä¸»çº¿å®Œæ•´æ•…äº‹

```bash
gen-main-thread --city "æ­å·"
```

**è¾“å‡ºæ–‡ä»¶:** `æ­å·_main_thread.md`
**å†…å®¹:** å®Œæ•´ä¸»çº¿æ•…äº‹ (Markdown, â‰¥5000å­—)
- Bç«™UPä¸»é£æ ¼
- æ²‰æµ¸å¼ç¬¬äºŒäººç§°å™è¿°
- 8-10ä¸ªç« èŠ‚ï¼Œæ¯ç« 500-800å­—
- å®Œæ•´çš„å¼€åœºã€é«˜æ½®ã€ç»“å±€

**ä¾èµ–:** éœ€è¦å…ˆè¿è¡Œ `gen-gdd`

#### 4.2 (å¯é€‰) ç”Ÿæˆåˆ†æ”¯æ•…äº‹

```bash
gen-branch --city "æ­å·" --branch-name "åº—ä¸»çº¿"
gen-branch --city "æ­å·" --branch-name "é¡¾å®¢çº¿"
```

**è¾“å‡ºæ–‡ä»¶:** `æ­å·_branch_åº—ä¸»çº¿.md`
**å†…å®¹:** åˆ†æ”¯æ•…äº‹ (Markdown)

**ä¾èµ–:** éœ€è¦å…ˆè¿è¡Œ `gen-lore-v2`

---

## âš¡ ç®€åŒ–æµç¨‹ (å¿«é€Ÿç”Ÿæˆ)

é€‚ç”¨äºï¼š
- å¿«é€ŸåŸå‹
- ä¸éœ€è¦å®Œæ•´æ¸¸æˆç³»ç»Ÿ
- åªéœ€è¦ä¸€ä¸ªå•çº¿æ•…äº‹

```bash
# Step 1: è·å–å€™é€‰
set-city --city "æ­å·"

# Step 2: ç”Ÿæˆç»“æ„
get-struct --city "æ­å·" --index 1

# Step 3: ç”Ÿæˆç®€åŒ–ç‰ˆæ•…äº‹
get-story --city "æ­å·"
```

**è¾“å‡ºæ–‡ä»¶:** `æ­å·_story.md`
**ç‰¹ç‚¹:**
- è·³è¿‡ Lore v2ã€ä¸»è§’è®¾è®¡ã€GDD
- ç›´æ¥åŸºäº struct.json ç”Ÿæˆæ•…äº‹
- æ›´å¿«ï¼Œä½†ç¼ºå°‘æ·±åº¦ç³»ç»Ÿè®¾è®¡

---

## ğŸ“š å‘½ä»¤å‚è€ƒ

### Stage 1 å‘½ä»¤

| å‘½ä»¤ | è¯´æ˜ | ä¸»è¦å‚æ•° |
|------|------|----------|
| `set-city` | è·å–å€™é€‰æ•…äº‹åˆ—è¡¨ | `--city` |
| `get-struct` | ç”Ÿæˆæ•…äº‹ç»“æ„æ¡†æ¶ | `--city`, `--index`/`--title` |

### Stage 2 å‘½ä»¤

| å‘½ä»¤ | è¯´æ˜ | ä¸»è¦å‚æ•° |
|------|------|----------|
| `get-lore` | ç”Ÿæˆ Lore v1 | `--city`, `--index`/`--title` |
| `gen-protagonist` | ç”Ÿæˆä¸»è§’è®¾è®¡ | `--city`, `--lore` |

### Stage 3 å‘½ä»¤

| å‘½ä»¤ | è¯´æ˜ | ä¸»è¦å‚æ•° |
|------|------|----------|
| `gen-lore-v2` | ç”Ÿæˆ Lore v2 | `--city`, `--lore-v1` |
| `gen-gdd` | ç”Ÿæˆ GDD | `--city`, `--lore-v2`, `--protagonist` |

### Stage 4 å‘½ä»¤

| å‘½ä»¤ | è¯´æ˜ | ä¸»è¦å‚æ•° |
|------|------|----------|
| `gen-main-thread` | ç”Ÿæˆä¸»çº¿æ•…äº‹ | `--city`, `--gdd`, `--lore-v2` |
| `gen-branch` | ç”Ÿæˆåˆ†æ”¯æ•…äº‹ | `--city`, `--branch-name`, `--lore-v2` |

### Legacy å‘½ä»¤

| å‘½ä»¤ | è¯´æ˜ | å¤‡æ³¨ |
|------|------|------|
| `get-story` | ç®€åŒ–ç‰ˆæ•…äº‹ç”Ÿæˆ | æ—§ç‰ˆï¼Œä¸ä½¿ç”¨ GDD |
| `gen-role` | ç”Ÿæˆè§’è‰²æ‹ç‚¹ | æ—§ç‰ˆ |
| `validate-role` | éªŒè¯è§’è‰²ä¸€è‡´æ€§ | æ—§ç‰ˆ |

---

## ğŸ“ æ–‡ä»¶è¾“å‡ºè¯´æ˜

### å®Œæ•´æµç¨‹è¾“å‡ºæ–‡ä»¶ï¼ˆ8ä¸ªï¼‰

```
æ­å·_candidates.json      # å€™é€‰åˆ—è¡¨
æ­å·_struct.json          # æ•…äº‹ç»“æ„
æ­å·_lore.json            # Lore v1 (JSON)
æ­å·_protagonist.md       # ä¸»è§’è®¾è®¡ (Markdown)
æ­å·_lore_v2.md           # Lore v2 (Markdown, ç³»ç»Ÿå¢å¼º)
æ­å·_GDD.md               # AI å¯¼æ¼”ä»»åŠ¡ç®€æŠ¥
æ­å·_main_thread.md       # ä¸»çº¿å®Œæ•´æ•…äº‹ (â‰¥5000å­—)
æ­å·_branch_åº—ä¸»çº¿.md     # åˆ†æ”¯æ•…äº‹ (å¯é€‰)
```

### ç®€åŒ–æµç¨‹è¾“å‡ºæ–‡ä»¶ï¼ˆ3ä¸ªï¼‰

```
æ­å·_candidates.json      # å€™é€‰åˆ—è¡¨
æ­å·_struct.json          # æ•…äº‹ç»“æ„
æ­å·_story.md             # ç®€åŒ–ç‰ˆæ•…äº‹
```

---

## ğŸ¯ æ¨èå·¥ä½œæµ

### 1. å†…å®¹åˆ›ä½œè€…ï¼ˆåªéœ€è¦æ•…äº‹ï¼‰

```bash
set-city --city "åŸå¸‚å"
get-struct --city "åŸå¸‚å" --index 1
get-story --city "åŸå¸‚å"
```

### 2. æ¸¸æˆå¼€å‘è€…ï¼ˆéœ€è¦å®Œæ•´ç³»ç»Ÿï¼‰

```bash
# ä¾æ¬¡è¿è¡Œå®Œæ•´æµç¨‹çš„ 1-7 æ­¥
set-city â†’ get-struct â†’ get-lore â†’ gen-protagonist â†’ gen-lore-v2 â†’ gen-gdd â†’ gen-main-thread
```

### 3. ç ”ç©¶è€…/è®¾è®¡å¸ˆï¼ˆéœ€è¦åˆ†ææ–‡æ¡£ï¼‰

```bash
# è¿è¡Œåˆ° Stage 3 å³å¯
set-city â†’ get-struct â†’ get-lore â†’ gen-protagonist â†’ gen-lore-v2 â†’ gen-gdd
```

---

## ğŸ”§ é«˜çº§é€‰é¡¹

### è‡ªå®šä¹‰è¾“å‡ºè·¯å¾„

æ‰€æœ‰å‘½ä»¤æ”¯æŒ `--out` å‚æ•°ï¼š

```bash
gen-main-thread --city "æ­å·" --out "deliverables/æ­å·_ä¸»çº¿.md"
```

### æŒ‡å®šè¾“å…¥æ–‡ä»¶

å¦‚æœæ–‡ä»¶åä¸æ˜¯é»˜è®¤æ ¼å¼ï¼š

```bash
gen-lore-v2 --city "æ­å·" --lore-v1 "custom_lore.json"
gen-gdd --city "æ­å·" --lore-v2 "custom_lore_v2.md" --protagonist "custom_protagonist.md"
```

---

## ğŸ› ï¸ æ•…éšœæ’æŸ¥

### é—®é¢˜ 1: å‘½ä»¤æœªæ‰¾åˆ°

```bash
# é‡æ–°å®‰è£…
uv pip install -e .
```

### é—®é¢˜ 2: Kimi API è¶…æ—¶

- æ£€æŸ¥ `.env` ä¸­çš„ `KIMI_API_KEY`
- åˆ†æ­¥æ‰§è¡Œï¼Œé¿å…é•¿æ—¶é—´è¿è¡Œ

### é—®é¢˜ 3: ç¼ºå°‘ä¾èµ–æ–‡ä»¶

- ç¡®ä¿æŒ‰é¡ºåºæ‰§è¡Œå‘½ä»¤
- æ£€æŸ¥å‰ç½®æ­¥éª¤æ˜¯å¦æˆåŠŸç”Ÿæˆæ–‡ä»¶

---

## ğŸ“– ç›¸å…³æ–‡æ¡£

- [templates/README.md](./templates/README.md) - è®¾è®¡æ–‡æ¡£æ€»è§ˆ
- [templates/00-index.md](./templates/00-index.md) - templatesç´¢å¼•ä¸ä¸Šä¸‹æ–‡ç®¡ç†
- [templates/00-architecture.md](./templates/00-architecture.md) - æ¶æ„è®¾è®¡
- [SPEC.md](./SPEC.md) - é¡¹ç›®è§„èŒƒ
- [USAGE.md](./USAGE.md) - ä½¿ç”¨è¯´æ˜

---

## âœ¨ ç¤ºä¾‹ï¼šæ­å·å®Œæ•´æµç¨‹

```bash
# 1. è·å–å€™é€‰
set-city --city "æ­å·"
# è¾“å‡º: æ­å·_candidates.json (6ä¸ªå€™é€‰æ•…äº‹)

# 2. é€‰æ‹©ç¬¬1ä¸ªæ•…äº‹
get-struct --city "æ­å·" --index 1
# è¾“å‡º: æ­å·_struct.json ("åŒ—é«˜å³°åˆå¤œç¼†è½¦ç©ºå¢")

# 3. ç”Ÿæˆ Lore v1
get-lore --city "æ­å·" --index 1
# è¾“å‡º: æ­å·_lore.json (ä¸–ç•Œè§‚åŸºç¡€)

# 4. åˆ†æä¸»è§’
gen-protagonist --city "æ­å·"
# è¾“å‡º: æ­å·_protagonist.md (ä¸»è§’åˆ†ææŠ¥å‘Š)

# 5. å‡çº§ä¸º Lore v2
gen-lore-v2 --city "æ­å·"
# è¾“å‡º: æ­å·_lore_v2.md (å«å…±é¸£åº¦ç³»ç»Ÿ)

# 6. ç”Ÿæˆ GDD
gen-gdd --city "æ­å·"
# è¾“å‡º: æ­å·_GDD.md (AIå¯¼æ¼”ä»»åŠ¡ç®€æŠ¥)

# 7. ç”Ÿæˆä¸»çº¿æ•…äº‹
gen-main-thread --city "æ­å·"
# è¾“å‡º: æ­å·_main_thread.md (â‰¥5000å­—å®Œæ•´æ•…äº‹)

# 8. (å¯é€‰) ç”Ÿæˆåˆ†æ”¯
gen-branch --city "æ­å·" --branch-name "æ£€ä¿®å·¥çº¿"
# è¾“å‡º: æ­å·_branch_æ£€ä¿®å·¥çº¿.md
```

---

**Happy Storytelling! ğŸ­ğŸ‘»**

